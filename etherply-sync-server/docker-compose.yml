version: '3.8'

services:
  etherply:
    build: .
    image: etherply/sync-server:latest
    container_name: etherply-server
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      - etherply_data:/data
    environment:
      - PORT=8080
      - LOG_LEVEL=info
      - SYNC_STRATEGY=automerge
      # Replace with your actual secret in production
      - ETHERPLY_JWT_SECRET=${ETHERPLY_JWT_SECRET:-dev-secret-do-not-use-in-prod}
      # Replication config (Optional)
      # - NATS_URL=nats://nats:4222
      # - REGION=us-east-1
      # - SERVER_ID=server-1

volumes:
  etherply_data:
